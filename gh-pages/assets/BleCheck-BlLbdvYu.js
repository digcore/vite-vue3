import{o as D,n as _,g as w,w as A,a as N,b as W,s as y,r as j,c as T,d as O,t as m,u as c,e as q,f as p,h as v,i as S,j as h,k as B,l as g}from"./index-C7WV1bLa.js";function x(e){return N()?(W(e),!0):!1}const E=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const I=Object.prototype.toString,L=e=>I.call(e)==="[object Object]";function V(e){return w()}function k(e){return Array.isArray(e)?e:[e]}function G(e,n=!0,o){V()?D(e,o):n?e():_(e)}function P(e,n,o){return A(e,n,{...o,immediate:!0})}const R=E?window:void 0,$=E?window.navigator:void 0;function Y(e){var n;const o=m(e);return(n=o==null?void 0:o.$el)!=null?n:o}function z(...e){const n=[],o=()=>{n.forEach(t=>t()),n.length=0},d=(t,u,r,a)=>(t.addEventListener(u,r,a),()=>t.removeEventListener(u,r,a)),s=T(()=>{const t=k(m(e[0])).filter(u=>u!=null);return t.every(u=>typeof u!="string")?t:void 0}),f=P(()=>{var t,u;return[(u=(t=s.value)==null?void 0:t.map(r=>Y(r)))!=null?u:[R].filter(r=>r!=null),k(m(s.value?e[1]:e[0])),k(c(s.value?e[2]:e[1])),m(s.value?e[3]:e[2])]},([t,u,r,a])=>{if(o(),!(t!=null&&t.length)||!(u!=null&&u.length)||!(r!=null&&r.length))return;const b=L(a)?{...a}:a;n.push(...t.flatMap(C=>u.flatMap(i=>r.map(M=>d(C,i,M,b)))))},{flush:"post"}),l=()=>{f(),o()};return x(o),l}function F(){const e=O(!1),n=w();return n&&D(()=>{e.value=!0},n),e}function H(e){const n=F();return T(()=>(n.value,!!e()))}function J(e){let{acceptAllDevices:n=!1}=e;const{filters:o=void 0,optionalServices:d=void 0,navigator:s=$}=e,f=H(()=>s&&"bluetooth"in s),l=y(),t=y(null);A(l,()=>{C()});async function u(){if(f.value){t.value=null,o&&o.length>0&&(n=!1);try{l.value=await(s==null?void 0:s.bluetooth.requestDevice({acceptAllDevices:n,filters:o,optionalServices:d}))}catch(i){t.value=i}}}const r=y(),a=y(!1);function b(){a.value=!1,l.value=void 0,r.value=void 0}async function C(){if(t.value=null,l.value&&l.value.gatt){z(l,"gattserverdisconnected",b,{passive:!0});try{r.value=await l.value.gatt.connect(),a.value=r.value.connected}catch(i){t.value=i}}}return G(()=>{var i;l.value&&((i=l.value.gatt)==null||i.connect())}),x(()=>{var i;l.value&&((i=l.value.gatt)==null||i.disconnect())}),{isSupported:f,isConnected:j(a),device:l,requestDevice:u,server:r,error:t}}const K={class:"grid grid-cols-1 gap-x-4 gap-y-4"},Q={key:0},U={key:1},X={key:2,class:"bg-green-500 text-white p-3 rounded-md"},Z={key:3,class:"bg-orange-800 text-white p-3 rounded-md"},ee={key:4},te={class:"block p-5 whitespace-pre"},oe=q({__name:"BleCheck",setup(e){const{isConnected:n,isSupported:o,device:d,requestDevice:s,error:f}=J({acceptAllDevices:!0});return console.log("isConnected:",n),console.log("isSupported:",o),console.log("device:",d),console.log("error:",f),(l,t)=>(g(),p("div",K,[v("div",null,S(c(o)?"Bluetooth Web API Supported":"Your browser does not support the Bluetooth Web API"),1),c(o)?(g(),p("div",Q,[v("button",{onClick:t[0]||(t[0]=u=>c(s)())}," Request Bluetooth Device ")])):h("",!0),c(d)?(g(),p("div",U,[v("p",null,"Device Name: "+S(c(d).name),1)])):h("",!0),c(n)?(g(),p("div",X,t[1]||(t[1]=[v("p",null,"Connected",-1)]))):h("",!0),c(n)?h("",!0):(g(),p("div",Z,t[2]||(t[2]=[v("p",null,"Not Connected",-1)]))),c(f)?(g(),p("div",ee,[t[5]||(t[5]=v("div",null,"Errors:",-1)),v("pre",null,[t[3]||(t[3]=B("      ")),v("code",te,S(c(f)),1),t[4]||(t[4]=B(`
    `))])])):h("",!0)]))}});export{oe as default};
